<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Lecture Notes</title>
    <style>
        .custom::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            background-color: #F5F5F5;
        }

        .custom::-webkit-scrollbar {
            width: 12px;
            background-color: #F5F5F5;
        }

        .custom::-webkit-scrollbar-thumb {
            border-radius: 10px;
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);
            background-color: #993aec;
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen font-sans">
    <div
    class="w-1/5 bg-gradient-to-b h-screen fixed from-purple-300 via-purple-400 to-purple-600 p-4 rounded-2xl overflow-y-auto custom">
    <nav>
        <ul class="space-y-4">
            <li><a href="../Home/home.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Home</a>
            </li>
            <li><a href="../course outline/outline.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Course
                    Outline</a></li>
            <li><a href="../course description/resdes.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Course
                    Description</a></li>
            <li><a href="../Copy of lecture notes/notes.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Lecture
                    Notes</a></li>
            <li><a href="../Copy of Question papers/papers.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Question
                    Papers</a></li>
            <li><a href="../Model solution/modelsol.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Model
                    Solutions</a></li>
            <li><a href="../samples/samples.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Samples</a>
            </li>
            <li><a href="../Course log/courselog.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Course
                    Log</a></li>
            <li><a href="../Outcome Assesment/assesment.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Outcome
                    Assessment</a></li>
            <li><a href="../Course folder verfication report/resverf.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Folder
                    Verification</a></li>
            <li><a href="../Manage logins/managelogin.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Manage
                    Login</a></li>
            <li><a href="./login/login.html"
                    class="block text-center bg-white text-black font-bold py-3 rounded-xl hover:bg-gray-200">Logout</a>
            </li>
        </ul>
    </nav>
</div>
    <div class="ml-[calc(100vw/5)] flex flex-col items-center py-8 space-y-6">
        <!-- Page Heading -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-purple-700">Lecture Notes</h1>
            <p class="text-gray-600">Manage notes week by week</p>
        </div>

        <!-- Week Selection -->
        <div>
            <label for="week-select" class="block text-lg font-medium text-gray-700">Select Week</label>
            <select id="week-select" class="mt-2 block w-40 p-2 border border-gray-300 rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500">
                <option value="" disabled selected>Select Week</option>
                <!-- Options for weeks -->
                <script>
                    for (let i = 1; i <= 16; i++) {
                        document.write(`<option value="${i}">Week ${i}</option>`);
                    }
                </script>
            </select>
        </div>

        <!-- Upload and View Section -->
        <div class="bg-white p-6 rounded-lg shadow-md w-96">
            <h2 id="modalTitle" class="text-2xl font-semibold text-purple-600 mb-4">Week - Lecture Notes</h2>

            <!-- File Upload -->
            <div class="flex flex-col space-y-4">
                <input type="file" id="fileUpload" accept=".pdf" class="hidden">
                <button
                    class="bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition"
                    onclick="document.getElementById('fileUpload').click()">
                    Upload PDF
                </button>
                <div id="fileList" class="text-gray-700 space-y-2"></div>
            </div>
        </div>
    </div>

    <script>
        const state = {
            selectedWeek: null
        };

        document.getElementById('week-select').addEventListener('change', (event) => {
            const week = event.target.value;
            state.selectedWeek = week;
            document.getElementById('modalTitle').textContent = `Week ${week} - Lecture Notes`;
        });

        document.getElementById('fileUpload').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (!file || file.type !== 'application/pdf') {
                alert('Please upload a valid PDF file.');
                return;
            }

            if (!state.selectedWeek) {
                alert('Please select a week first.');
                return;
            }

            const courseTitle = localStorage.getItem('course'); // Assume course ID is stored in localStorage
            if (!courseTitle) {
                alert('Course title is missing.');
                return;
            }

            const formData = new FormData();
            
            
            formData.append('file', file);
            formData.append('week', state.selectedWeek);
            formData.append('courseTitle', courseTitle);

            try {                
                const response = await fetch('http://localhost:5000/api/teacher/lecture-notes/document', {
                    method: 'POST',
                    body: formData,
                });

                if (response.ok) {
                    const data = await response.json();
                    alert(`Lecture notes uploaded successfully for Week ${state.selectedWeek}!`);
                } else {
                    const errorData = await response.json();
                    alert(`Failed to upload: ${errorData.message}`);
                }
            } catch (error) {
                console.error('Error uploading lecture notes:', error);
                alert('An error occurred. Please try again.');
            } finally {
                event.target.value = ''; // Reset file input
            }
        });
    </script>
</body>

</html>
    